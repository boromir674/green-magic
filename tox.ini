
[tox]
envlist = clean,check,py37,report

[testenv]
basepython = {clean,check,report,graphs}: {env:TOXPYTHON:python3}
deps = -rrequirements/base.txt


###### MAIN ######
[testenv:py37]
basepython = {env:TOXPYTHON:python3}
deps =
    {[testenv]deps}
    -rrequirements/dev.txt
skip_install = False
use_develop = True
commands =
    python -c 'import nltk; nltk.download("stopwords"); nltk.download("punkt"); nltk.download("wordnet")'
    {posargs:pytest --cov --cov-report=term-missing -v}
;    pytest --cov --cov-report=term-missing

[testenv:py36-nocover]
basepython = {env:TOXPYTHON:python3.6}
deps =
    {[testenv]deps}
    pytest
skip_install = True
use_develop = True
commands = {posargs:pytest -vv -s}


###### SUPPORT ######
[testenv:clean]
skip_install = True
deps = coverage
commands = coverage erase

[testenv:check]
deps =
    docutils
    readme-renderer
    pygments
    check-manifest
skip_install = True
commands =
    python setup.py check --strict --metadata --restructuredtext
    check-manifest {toxinidir}


[testenv:report]
skip_install = True
deps = coverage
commands = coverage report --skip-covered

[testenv:graphs]
skip_install = True
deps = pydeps
commands = {posargs:pydeps --noshow}

[testenv:nltk-support]
skip_install = True
deps = nltk
commands = python -c 'import nltk; nltk.download("stopwords")'
